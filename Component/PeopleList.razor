
<table class="table table-sm table-bordered table-striped">
    <thead>
        <tr>
            <th>ID</th>
            <th>Name</th>
            <th>Dept</th>
            <th>Location</th>
        </tr>
    </thead>
    <tbody>
          @foreach (Person p in People) { 
          <tr class="@GetClass(p.Location.City)">
              <td>@p.PersonId</td>
              <td>@p.Surname, @p.Location.State</td>            
              <td>@p.Department.Name</td>
              <td>@p.Location.City,@p.Location.State</td>
          </tr>
             
          }
    </tbody> 
</table>

<div class="form-group">
    <label for="city"> City</label>
    <select name="city" class="form-control" @bind="SelectedCity">
        <option disabled selected> Select City</option>
        @foreach (string city in Cites) { 
            <option selected="@(SelectedCity==city)" value="@city"> @city</option>
        }
    </select>
</div>


@code {
    [Inject]
    public DataContext Context { get; set; }

    IEnumerable<Person> _people= null;

    public IEnumerable<Person> People {
        get {
            if (_people != null)
            {
                return _people;
            }
            else {
                var listofpeopel = Context.People.ToList();
                listofpeopel.ForEach(p => {
                    var personEntityEntry = Context.Entry(p);
                    personEntityEntry.Reference(p => p.Department).Load();
                    personEntityEntry.Reference(p => p.Location).Load();
                });

                _people = listofpeopel;
                return _people;
            }
        }
    }

    public IEnumerable<string> Cites {
        get {
            return People.Select(x => x.Location.City);
        }
    }

    public string SelectedCity { get; set; }

    public string GetClass(string selectedCity) {
        return SelectedCity == selectedCity ? "bg-info text-white" : "";
    }

}
